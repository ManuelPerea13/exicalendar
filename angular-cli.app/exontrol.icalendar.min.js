/* @license Copyright (C) Exontrol. All rights reserved. */
!function (t, n) { "object" == typeof exports && "undefined" != typeof module ? n(exports) : "function" == typeof define && define.amd ? define(["exports"], n) : (t = "undefined" != typeof globalThis ? globalThis : t || self, n(t.exontrol || {})) }(this, function (t) { "use strict"; var n = n || window.exontrol; n.Mrg(n, function () { function t(t) { return n.ToS(t).trim() } function i(t, i) { var r, e = n.ToS(t); return (i = n.ToS(i, N)) && (r = i.length - e.length) > 0 && (e = i.substr(0, r) + e), e } function r(t) { return "MINUTELY" == t ? "N" : t.charAt(0) } function e(t) { return t % w } function o(t) { return t - e(t) } function s(t, n, i, r, e, o) { return Date.Create(t, n, i, r, e, o) } function u(t, n, i) { return null != t && (t = s(t)), null == t ? t = n || i : (null != n && (n = s(n)) && (t = t.getTime() > n.getTime() ? t : n), null != i && (i = s(i)) && (t = t.getTime() < i.getTime() ? t : i)), t } function h(t) { return t.getUTCFullYear() } function c(t) { return t.getUTCMonth() + 1 } function a(t) { return t.getUTCDay() } function f(t) { return t.getUTCDate() } function l(t) { return t.getUTCHours() } function y(t) { return t.getUTCMinutes() } function p(t) { return t.getUTCSeconds() } function d(t, n) { var i = n - a(t = t.copy()); return i && t.addD(i < 0 ? i : -(A - i)), t } function v(t, n) { var i = n - a(t = t.copy()); return i && t.addD(i < 0 ? A + i : i), t } function g(t) { return 0 == (3 & t) && (t % 100 != 0 || t % 400 == 0) } function m(t) { return g(t) ? 366 : 365 } function D(t, n) { var i = U[n]; return 1 == n && g(t) && i++, i } function T(t, n) { return t.GetWeekNo({ firstWeekDay: n }) } function b(t, n) { var i = s(t + 1, 1, 4); return (i = d(i, n)).PrevDay(), T(i, n) } function B(t, n, i) { return i <= U[n] || 1 == n && 29 == i && g(t) } function E(i) { function r(t, n, i) { if (n.charAt(i) == t) return "n" == t && (t = "\n"), "r" == t && (t = "\r"), "t" == t && (t = "\t"), t } function e(n) { for (var i = 0, r = (n = n instanceof Array ? n : null != n ? [n] : []).length; i < r; i++)n[i] = t(n[i]); return n } var o, s, u, h, c, a, f = -1, l = !0; if (i && (c = n.ToI(i.C, 0), i.C = -1, i.V = "", ~c && null != i.W && (o = e(i.W), (u = i.P) && (a = o && o.length || 0)))) { h = u.length; for (var y, p, d = 0; l && c < h; c++) { if (y = u.charAt(c), p = "", u.startsWith(O, c)) { if ((s = e(i.E)).length && (i.EQ || !d)) for (var v, g = 0, m = s.length; !p && g < m; g++)(p = r(v = s[g], u, c + 1)) && (y = p, c += v.length) } else i.Q && u.indexOf(i.Q, c) && (y = "", d += d ? -1 : 1, c += i.Q.length - 1); if (!p && !d) for (var D, T = 0; l && T < a; T++)(D = o[T]) && u.startsWith(D, c) && (f = T, i.C = c + D.length, l = !1); l && (i.V += y) } l && c < h && (i.C = c) } return f } function M(t) { this.tD = n.Tick() + n.ToI(t, 2e3) } function Y(t, i, e) { this.nxt = this["n" + r(i)].bind(this), this.int = ~~Math.max(1, n.ToI(e, 1)), this.set(t) } function V(t) { this.oO = n.Mrg(n.Cpy(ht), t), this.init() } var R = new Map, U = "31,28,31,30,31,30,31,31,30,31,30,31".split(",").map(function (t) { return ~~t }), x = "byYD,byMD,byW,byD,byM".split(","), q = "0000", N = "00", w = n.msday, A = n.days, C = n.months, O = "\\", W = ";", S = "=", I = /^(\d\d\d\d\d\d\d\d)(|T\d\d\d\d\d\d(|Z))$/, k = "DTSTART", F = "WEEKLY", H = "MONTHLY", P = "YEARLY", L = new n.Arr(["SECONDLY", "MINUTELY", "HOURLY", "DAILY", F, H, P]), Q = new n.Arr(["DAILY", F, H, P]), z = "UNTIL", K = "COUNT", G = "INTERVAL", j = "BYSECOND", Z = "BYMINUTE", $ = "BYHOUR", J = "BYDAY", X = new n.Arr(["SU", "MO", "TU", "WE", "TH", "FR", "SA"]), _ = "BYMONTHDAY", tt = "BYYEARDAY", nt = "BYWEEKNO", it = "BYMONTH", rt = "BYSETPOS", et = "WKST", ot = new n.Arr(["SU", "MO", "TU", "WE", "TH", "FR", "SA"]), st = { empty: { code: -1, desc: "Error: Empty or Invalid recurrence." }, missFreq: { code: -2, desc: "Error: The FREQ rule is missing or invalid." }, invalidByWeekNo: { code: -10, desc: "Error: The BYWEEKNO rule part is empty or specifies no valid value. Valid values are 1 to 53 or -53 to -1." }, invalidByDay: { code: -11, desc: "Error: The BYDAY rule part is empty or specifies no valid value." }, invalidByMonthDay: { code: -12, desc: "Error: The BYMONTHDAY rule part is empty or specifies no valid value. Valid values are 1 to 31 or -31 to -1." }, invalidByYearDay: { code: -13, desc: "Error: The BYYEARDAY rule part is empty or specifies no valid value. Valid values are 1 to 366 or -366 to -1." }, invalidBySetPos: { code: -14, desc: "Error: The BYSETPOS rule part is empty or specifies no valid value. Valid values are 1 to 366 or -366 to -1." }, invalidByMonth: { code: -15, desc: "Error: The BYMONTH rule part is empty or specifies no valid value. Valid values are 1 to 12." }, invalidBySecond: { code: -16, desc: "Error: The BYSECOND rule part is empty or specifies no valid value. Valid values are 0 to 60." }, invalidByMinute: { code: -17, desc: "Error: The BYMINUTE rule part is empty or specifies no valid value. Valid values are 0 to 59." }, invalidByHour: { code: -18, desc: "Error: The BYHOUR rule part is empty or specifies no valid value. Valid values are 0 to 23." }, invalidWkst: { code: -19, desc: "Error: The WKST rule is invalid." }, invalidUntil: { code: -20, desc: "Error: The UNTIL rule is invalid." }, unknownRule: { code: -21, desc: "Error: Unknown RRULE property '...'." } }, ut = new n.Arr([k, "FREQ", z, K, G, j, Z, $, J, _, tt, nt, it, rt, et]); M.prototype.idle = function () { return n.Tick() < this.tD }, Y.prototype.set = function (t) { return this.y = h(t), this.m = c(t) - 1, this.d = f(t), this.h = l(t), this.n = y(t), this.s = p(t), this }, Y.prototype.get = function () { return this.iV() && s(this.y, this.m + 1, this.d, this.h, this.n, this.s) || null }, Y.prototype.iV = function () { return B(this.y, this.m, this.d) }, Y.prototype.aID = function () { return this.d = U[this.m], this.iV() }, Y.prototype.next = function () { return this.nxt(), this.iV() }, Y.prototype.nY = function (t) { this.y += t || this.int }, Y.prototype.nM = function (t) { t = t || this.int, this.y += ~~(t / C), this.m += t % C, this.m >= C && (this.m -= C, this.y++) }, Y.prototype.nW = function (t) { var n = this.get(); n && this.set(n.NextWeek(t || this.int)) }, Y.prototype.nD = function (t) { var n = this.get(); n && this.set(n.NextDay(t || this.int)) }, Y.prototype.nH = function (t) { var n = ~~((t = t || this.int) / 24); n && this.nD(n), this.h += t % 24, this.h >= 24 && (this.h -= 24, this.nD(1)) }, Y.prototype.nN = function (t) { var n = ~~((t = t || this.int) / 60); n && this.nH(n), this.n += t % 60, this.n >= 60 && (this.n -= 60, this.nH(1)) }, Y.prototype.nS = function (t) { var n = ~~((t = t || this.int) / 60); n && this.nN(n), this.s += t % 60, this.s >= 60 && (this.s -= 60, this.nN(1)) }; var ht = { ignoreUnknownRule: !0 }; return V.version = "1.8", V.type = "IRecur", V.count = 256, V.toU = function (t) { return n.ToS(t).toUpperCase() }, V.Parse = function (r, e) { n.IsO(r) && (r = function (r) { function e(r) { return n.IsD(r) ? function (t) { var n = i(h(t), q) + i(c(t)) + i(f(t)); return (l(t) || y(t) || p(t)) && (n += i(l(t)) + i(y(t)) + i(p(t)) + "Z"), n }(r) : t(r) } var o = ""; if (r) for (var s in r) o += (o.length ? W : "") + s + S + e(r[s]); return o }(r)), r = t(r); var o = R.get(r); return !o && R.set(r, o = new V(e).parse(r)), o }, V.prototype.init = function () { this.mR = null, this.oE = null, this.oT = null, this.r = null }, V.prototype.parse = function (i) { function e(t) { var n, i, r, e = void 0; return t && (n = t.match(I)) && (i = [~~(r = n[1]).substr(0, 4), ~~r.substr(4, 2), ~~r.substr(6, 2)], Date.parse(i.join("-")) && (i[1]--, (r = n[2]) && (r = r.substr(1)) && (i.push(~~r.substr(0, 2)), i.push(~~r.substr(2, 2)), i.push(~~r.substr(4, 2))), e = n[3] || !r ? new Date(Date.UTC(i[0], i[1], i[2], i[3] || 0, i[4] || 0, i[5] || 0)) : new Date(i[0], i[1], i[2], i[3] || 0, i[4] || 0, i[5] || 0), isNaN(e) && (e = void 0))), e } function o(i, r) { this.oE || (this.oE = i, (r = t(r)) && (this.oE = n.Cpy(this.oE)) && (this.oE.desc = this.oE.desc.replace("...", r))) } function u(t, n, i) { var r = this.get(t); return null != r && (null != (r = n.call(this, r)) ? this.set(t, r) : (this.del(t), i && o.call(this, i))), !this.oE } function c() { function t() { function t(t, n) { var i = [], r = [], e = { l: !0 }; this.r.fR(t, e); for (var o = e.s.copy(), s = e.e.getTime(); o.getTime() <= s; o.NextDay())this.vBy(o) && r.push(o.copy()); return r.length && (n ? n.forEach(function (t) { var n = function (t, n) { if (t < 0 && (t = n.length + t + 1), --t >= 0 && t < n.length) return n[t] }(t, r); n && i.push(n) }) : i = r), i } function n(t) { var n = t.d, i = this.toF(t.f); this.enumD({ s: t.s, u: t.u, c: t.c }, function (t) { return !this.vBy(t.date) || this.enumT(t.date, function (r) { return !t.out(r) && n.pushnn(i(r.getTime())), t.idle() && (!t.count || n.len() < t.count) }) }) } function i(t) { var n = t.d, i = this.toF(t.f), r = this.toDS(t.s), e = r.getTime(), o = f(r), u = l(r), c = y(r), a = p(r); this.enumD({ s: t.s, u: t.u, c: t.c, a: !0 }, function (t) { return !function (t, n, i, r, e, o, u) { var h, c = []; return n && n.forEach(function (n) { B(t, n - 1, i) && (h = s(t, n, i, r, e, o), (!u || h.getTime() >= u) && c.push(h)) }), c }.call(this, h(t.date), this.r.byM, o, u, c, a, e).forEachU(function (r) { return !this.enumT(r, function (r) { return !t.out(r) && n.pushnn(i(r.getTime())), t.idle() && (!t.count || n.len() < t.count) }) }, this) }) } var r = this.r, e = this.freq(); r.byP = this.bysetpos(), r.byT = function () { var t = this.bytime($), n = this.bytime(Z), i = this.bytime(j); return (t || n || i) && [t, n, i] }.call(this), r.c ? (r.eA = n.bind(this), Q.has(e) && (r.eA = (r.byP ? function (n) { var i = n.d, r = this.toF(n.f); this.enumD({ s: n.s, u: n.u, c: n.c, a: !0 }, function (n) { return !t.call(this, n.date, this.r.byP).forEachU(function (t) { return !this.enumT(t, function (t) { return !n.out(t) && i.pushnn(r(t.getTime())), n.idle() && (!n.count || i.len() < n.count) }) }, this) }) } : function (n) { var i = n.d, r = this.toF(n.f); this.enumD({ s: n.s, u: n.u, c: n.c, a: !0 }, function (n) { return !t.call(this, n.date).forEachU(function (t) { return !this.enumT(t, function (t) { return !n.out(t) && i.pushnn(r(t.getTime())), n.idle() && (!n.count || i.len() < n.count) }) }, this) }) }).bind(this), r.byM && 1 == r.rgqVBy.length && (e == F || e == H ? r.eA = n.bind(this) : e == P && (r.eA = i.bind(this))))) : r.eA = function (t) { var n = t.d, i = this.toF(t.f); this.enumD({ s: t.s, u: t.u, c: t.c }, function (t) { return this.enumT(t.date, function (r) { return !t.out(r) && n.pushnn(i(r.getTime())), t.idle() && (!t.count || n.len() < t.count) }) }) }.bind(this) } if (this.mR && this.mR.size) if (~L.indexOf(this.freq())) { var i; u.call(this, k, function (t) { return e(t) }), u.call(this, G, function (t) { return Math.max(1, ~~t) }), u.call(this, K, function (t) { return ~~t }), u.call(this, z, function (t) { return e(t) }, st.invalidUntil) && u.call(this, et, function (t) { if (~(t = ot.indexOf(t))) return t }, st.invalidWkst) && u.call(this, nt, function (t) { return a(t, -53, 53, 0) }, st.invalidByWeekNo) && u.call(this, J, function (t) { return function (t) { var n, i, r, e; return t.split(",").forEach(function (t) { r = t.substr(t.length - 2), (i = ~(r = X.indexOf(r))) && ((t = t.substr(0, t.length - 2).trim()) && !t.match(/^(|[+-])\d(|\d)$/) || ((t = ~~t) && (i = t >= -53 && t <= 53), i && (e = (n = n || new Map).get(r), !~(e = e || []).indexOf(t) && e.push(t), !e.z && (e.z = !t), n.set(r, e)))) }), n }(t) }, st.invalidByDay) && u.call(this, _, function (t) { return a(t, -31, 31, 0) }, st.invalidByMonthDay) && u.call(this, tt, function (t) { return a(t, -366, 366, 0) }, st.invalidByYearDay) && u.call(this, rt, function (t) { return a(t, -366, 366, 0) }, st.invalidBySetPos) && u.call(this, it, function (t) { return a(t, 1, 12) }, st.invalidByMonth) && u.call(this, $, function (t) { return a(t, 0, 23) }, st.invalidByHour) && u.call(this, Z, function (t) { return a(t, 0, 59) }, st.invalidByMinute) && u.call(this, j, function (t) { return a(t, 0, 60) }, st.invalidBySecond) && (this.oO.ignoreUnknownRule || !(i = function () { var t; return this.mR && this.mR.forEach(function (n, i) { t || ut.has(i) || (t = i) }), t }.call(this)) ? (this.r = {}, function () { var t = this.freq(); this.r.fR = this["fR" + r(t)].bind(this) }.call(this), function () { var t, n, i = this.r; i.rgqVBy = [], (t = this.bymonth()) && (i.byM = t, i.rgqVBy.push(this.qVbyM)), (t = this.byweekno()) && (i.byW = t, i.rgqVBy.push(this.qVbyW)), (t = this.bymonthday()) && (i.byMD = t, i.rgqVBy.push(this.qVbyMD)), (t = this.byyearday()) && (i.byYD = t, i.rgqVBy.push(this.qVbyYD)), (t = this.byday()) && (i.byD = t, (n = this.freq()) == H ? i.rgqVBy.push(this.qVbyDM) : n == P ? i.byM ? i.rgqVBy.push(this.qVbyDM) : i.rgqVBy.push(this.qVbyDY) : i.rgqVBy.push(this.qVbyD)) }.call(this), function () { var t = this.r; x.forEachU(function (i) { return t[i] && (t.c = this["c" + n.getP(i)].bind(this)) && (t.cN = i) }, this) }.call(this), function () { var t = this.r; t.rgV = [], t.c && x.forEach(function (i) { t[i] && t.rgV.push(this["v" + n.getP(i)]) }, this) }.call(this), t.call(this)) : o.call(this, st.unknownRule, i)) } else o.call(this, st.missFreq); else o.call(this, st.empty); return this } function a(t, i, r, e) { var o; return t && t.split(",").forEach(function (t) { n.IsI(t) && (t = ~~t, null != e && t == e || t >= i && t <= r && !~(o = o || []).indexOf(t) && o.push(t)) }), o } if (this.init(), i = t(i)) { var d, v = { P: i, C: 0, W: W }; for (this.mR = new Map; ~v.C;)E(v), ~E(d = { P: v.V, C: 0, W: S }) && this.set(d.V.trim(), V.toU(v.V.substr(d.C).trim())) } return c.call(this) }, V.prototype.valid = function () { return !this.oE }, V.prototype.error = function () { return this.oE && this.oE.desc || "" }, V.prototype.get = function (t) { return this.mR && this.mR.get(V.toU(t)) }, V.prototype.has = function (t) { return this.mR && this.mR.has(V.toU(t)) }, V.prototype.set = function (t, n) { this.mR && this.mR.set(V.toU(t), n) }, V.prototype.del = function (t) { this.mR && this.mR.delete(V.toU(t)) }, V.prototype.freq = function () { return this.get("FREQ") }, V.prototype.interval = function () { return ~~Math.max(1, this.get(G)) }, V.prototype.count = function () { return ~~Math.max(1, this.get(K)) }, V.prototype.dtstart = function () { return this.get(k) || Date.Now() }, V.prototype.until = function () { return this.get(z) }, V.prototype.wkst = function () { return this.has(et) ? this.get(et) : 1 }, V.prototype.bymonth = function () { var t = this.get(it); return t && new n.Arr(t) }, V.prototype.byweekno = function () { var t = this.get(nt); return t && new n.Arr(t) }, V.prototype.bymonthday = function () { var t = this.get(_); return t && new n.Arr(t) }, V.prototype.byyearday = function () { var t = this.get(tt); return t && new n.Arr(t) }, V.prototype.byday = function () { return this.get(J) }, V.prototype.bysetpos = function () { var t = this.get(rt); return t && new n.Arr(t) }, V.prototype.dFR = function (t, n, i) { if (t.l) { var r = this.r.dS.getTime(); n = Math.max(n, r), i = Math.max(i, r) } t.s = new Date(n), t.e = new Date(i) }, V.prototype.bytime = function (t) { var n = this.get(t); return n && n.slice() }, V.prototype.fRY = function (t, n) { var i = h(t), r = e(this.r.dS.getTime()); return this.dFR(n, Date.UTC(i, 0, 1) + r, Date.UTC(i, 11, 31) + r), i }, V.prototype.fRM = function (t, n) { var i = h(t), r = c(t) - 1, o = e(this.r.dS.getTime()); return this.dFR(n, Date.UTC(i, r, 1) + o, Date.UTC(i, r, D(i, r)) + o), r + 1 }, V.prototype.fRW = function (t, n) { var i = this.wkst(), r = d(t, i), s = e(this.r.dS.getTime()), u = o(r.getTime()); return this.dFR(n, u + s, u + (A - 1) * w + s), T(t, i) }, V.prototype.fRD = function (t, n) { var i = o(t.getTime()) + e(this.r.dS.getTime()); return this.dFR(n, i, i), f(t) }, V.prototype.fRH = function (t, n) { return l(t) }, V.prototype.fRN = function (t, n) { return y(t) }, V.prototype.fRS = function (t, n) { return p(t) }, V.prototype.qVbyM = function (t) { return ~this.r.byM.indexOf(c(t)) }, V.prototype.qVbyW = function (t) { var n = this.wkst(), i = this.r.byW, r = T(t, n); return ~i.indexOf(r) || ~i.indexOf(-(b(h(t), n) - (r - 1))) || 1 == r && 12 == c(t) && ~i.indexOf(-b(h(t) + 1, n)) || 53 == r && 1 == c(t) && ~i.indexOf(-(b(h(t) - 1, n) - (r - 1))) }, V.prototype.qVbyMD = function (t) { var n = f(t), i = this.r.byMD; return ~i.indexOf(n) || ~i.indexOf(-(D(h(t), c(t) - 1) - (n - 1))) }, V.prototype.qVbyYD = function (t) { var n = function (t) { return t.yDay() }(t) + 1, i = this.r.byYD; return ~i.indexOf(n) || ~i.indexOf(-(m(h(t)) - (n - 1))) }, V.prototype.qVbyWD = function (t) { return this.r.byD.get(a(t)) }, V.prototype.qVbyDM = function (t) { var n = this.qVbyWD(t); return n && (n.z || n.forEachU(function (n) { return function (n) { function i(n) { return h(t) == h(n) && c(t) == c(n) } var r = t.copy().addD(-n * A); return !i(r) && i(r.addD((n < 0 ? -1 : 1) * A)) }(n) })) }, V.prototype.qVbyDY = function (t) { var n = this.qVbyWD(t); return n && (n.z || n.forEachU(function (n) { return function (n) { function i(n) { return h(t) == h(n) } var r = t.copy().addD(-n * A); return !i(r) && i(r.addD((n < 0 ? -1 : 1) * A)) }(n) })) }, V.prototype.qVbyD = function (t) { return this.qVbyWD(t) }, V.prototype.qVby = function (t) { for (var n = !0, i = this.r.rgqVBy, r = 0, e = i.length; n && r < e; r++)n = i[r].call(this, t); return n }, V.prototype.cBy = function (t, i, r, e) { var o, s, u = this.r[r]; u && ((o = (s = this.r.mCC = this.r.mCC || new n.M2).get(r, i)) || (o = new n.Arr, e.call(this, o, i, u), s.set(r, i, o)), t.push(o)) }, V.prototype.cByYD = function (t, n) { this.cBy(t, n, "byYD", function (t, n, i) { i.forEach(function (i) { i < 0 && (i = m(n) + (i + 1)); var r = s(n, 1, 1).addD(i - 1); r.GetYear() == n && t.add(r.getTime()) }) }) }, V.prototype.cByMD = function (t, n) { this.cBy(t, n, "byMD", function (t, n, i) { i.forEach(function (i) { for (var r, e, o = 1; o <= C; o++)e = i, r = D(n, o - 1), e < 0 && (e = r + e + 1), e >= 1 && e <= r && t.add(s(n, o, e).getTime()) }) }) }, V.prototype.cByW = function (t, n) { var i = this.wkst(); this.cBy(t, n, "byW", function (t, n, r) { r.forEach(function (r) { var e, o = b(n, i); if (r < 0 && (r = o + r + 1), r >= 1 && r <= o) { for (e = d(s(n, 1, 1), i).addD(Math.max(0, r - 1) * A); T(e, i) != r;)e.NextDay(); for (var u = 0; u < A; u++, e.NextDay())t.add(e.getTime()) } }) }) }, V.prototype.cByD = function (t, n) { function i(t, n, i) { for (var r = v(s(n, 1, 1), i); h(r) == n;)t.add(r.getTime()), r.NextWeek() } var r = this.freq(), e = i; r == H || r == P && this.r.byM ? e = function (t, n, r, e) { if (e) { var o = e > 0; e = o ? e - 1 : e + 1; for (var u, a = 1; a <= C; a++)u = s(n, a, 1), (u = o ? v(u, r) : d(u.NextMonth().PrevDay(), r)).addD(e * A), h(u) == n && c(u) == a && t.add(u.getTime()) } else i(t, n, r) } : r == P && (e = function (t, n, r, e) { if (e) { var o = e > 0, u = s(n, 1, 1); e = o ? e - 1 : e + 1, (u = o ? v(u, r) : d(u.NextYear().PrevDay(), r)).addD(e * A), h(u) == n && t.add(u.getTime()) } else i(t, n, r) }), this.cBy(t, n, "byD", function (t, n, r) { r.forEach(function (r, o) { r.forEach(function (r) { (r ? e : i)(t, n, o, r) }) }) }) }, V.prototype.cByM = function (t, n) { this.cBy(t, n, "byM", function (t, n, i) { i.forEach(function (i) { for (var r = 1, e = D(n, i - 1), o = s(n, i, 1); r <= e; r++, o.NextDay())t.add(o.getTime()) }) }) }, V.prototype.val = function (t, i, r) { var e = new n.Arr, s = t.GetYear(); return i.call(this, e, s), r && (i.call(this, e, s - 1), i.call(this, e, s + 1)), e.has(o(t.getTime())) }, V.prototype.vByYD = function (t) { return this.val(t, this.cByYD) }, V.prototype.vByMD = function (t) { return this.val(t, this.cByMD) }, V.prototype.vByW = function (t) { return this.val(t, this.cByW, !0) }, V.prototype.vByD = function (t) { return this.val(t, this.cByD) }, V.prototype.vByM = function (t) { return this.val(t, this.cByM) }, V.prototype.vBy = function (t) { for (var n = !0, i = this.r.rgV, r = 0, e = i.length; n && r < e; r++)n = i[r].call(this, t); return n }, V.prototype.idle = function () { return !this.oT || this.oT.idle() }, V.prototype.next = function (t, n) { var i = t.next(); if (!i) if (n) i = t.aID(); else for (; !i && this.idle();)i = t.next(); return i }, V.prototype.toDS = function (t) { return u(t, this.get(k)) || this.dtstart() }, V.prototype.toDU = function (t) { return u(t, null, this.get(z)) || this.until() }, V.prototype.toC = function (t) { return Math.min(n.ToI(t, this.count()), this.count()) }, V.prototype.toF = function (t) { return (t instanceof Function ? t : function (t) { return t }).bind(this) }, V.prototype.enumD = function (t, n, i) { t = t || {}, i = i || this; var r, e, o = this.toDS(t.s), s = o.getTime(), u = this.toDU(t.u), h = u && u.getTime(), c = this.toC(t.c), a = new Y(o, this.freq(), this.interval()), f = { idle: this.idle.bind(this), out: function (t) { return h && t.getTime() > h ? 1 : t.getTime() < s ? -1 : 0 }, count: c || (h ? 0 : V.count) }, l = n; for (this.oT = new M(t.d), this.r.dS = o; l;)e = 0, (r = a.get()) && 1 != (e = f.out(r)) && (f.date = r, l = n.call(i, f)), l = l && f.idle() && 1 != e && this.next(a, t.a); this.oT = null }, V.prototype.enumT = function (t, n, i) { function r(t) { for (t = t || 0; t < o; t++)(D = b[t]) && (D.i = 0) } var e, o, u, a, d, v, g, m, D, T, b = this.r && this.r.byT, B = !0; if (b) { for (i = i || this, o = b.length, a = h(t), d = c(t), v = f(t), m = [l(t), y(t), p(t)], e = 0; null == u && e < o; e++)(D = b[e]) && (u = e); for (r(); B;) { for (g = m.slice(), e = 0; e < o; e++)(D = b[e]) && (g[e] = D[D.i = D.i || 0]); if (B = T = n.call(i, s(a, d, v, g[0], g[1], g[2]))) for (e = o - 1; e >= 0; e--)if (D = b[e]) { if (++D.i < D.length) break; r(e), B = e != u } } } else T = n.call(i, t); return T }, V.prototype.all = function (t) { t = t || {}; var i; return this.r && (i = new n.Arr, this.r.eA({ s: t.start, u: t.until, c: t.count, f: t.filter, d: i })), i }, { ICalendar: { IRecurOptions: ht, IRecur: V } } }()), t.ICalendar = n.ICalendar });